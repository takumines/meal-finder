# 機能仕様書: 食事決定アプリ (MealFinder)

**機能ブランチ**: `001-`  
**作成日**: 2025-09-13  
**ステータス**: 承認済み  
**入力**: ユーザー要求: "アキネーター形式のYes/No質問で、その日食べたいものを効率的に見つける食事決定アプリ。UIはTinderのようなイメージ"

## 実行フロー (メイン)
```
1. 入力からユーザー要求を解析
   → 解析結果: アキネーター形式のYes/No質問による食事決定アプリ
2. 要求から主要概念を抽出
   → 特定項目: 質問システム、食事提案、UI/UX、学習機能
3. 不明確な点について:
   → 該当箇所に [NEEDS CLARIFICATION] マークを付与
4. ユーザーシナリオ・テスト項目を作成
   → ユーザーフロー: 質問回答 → 食事提案 → アクション選択
5. 機能要件を生成
   → 各要件はテスト可能かつ測定可能
6. 主要エンティティを特定
   → User, Question, Meal, History, Preference
7. レビューチェックリストを実行
   → いくつかの [NEEDS CLARIFICATION] 項目が残存
8. 結果: 成功 (明確化項目あり、計画フェーズ準備完了)
```

---

## ⚡ 基本ガイドライン
- ✅ ユーザーのニーズ(何を)と理由(なぜ)に焦点を当てる
- ❌ 実装方法(どのように)は避ける（技術スタック、API、コード構造を含まない）
- 👥 開発者ではなくビジネス関係者向けに記述

---

## ユーザーシナリオ・テスト *(必須)*

### 主要ユーザーストーリー
20〜40代のユーザーが「今日何食べよう？」と迷った時に、最大10問のYes/No質問に答えることで、その日の気分や状況に最適な食事を効率的に見つけることができる。Tinderのような直感的なUIで簡単に操作でき、最終的に具体的な料理名の提案と実行可能なアクションオプションが提供される。

### 受入シナリオ
1. **Given** 初回利用ユーザーがアプリを起動、**When** プロファイル設定完了後に質問開始ボタンをタップ、**Then** 第1問目の質問が表示される
2. **Given** 5問回答済みの状態、**When** 6問目でNoを選択、**Then** 次の質問が表示され、No回数カウンターが更新される
3. **Given** 10問すべて回答完了、**When** 質問終了、**Then** 具体的な料理名と3つのアクションオプション（レストラン検索・デリバリー・レシピ）が表示される
4. **Given** No回数が5回到達、**When** さらにNoを選択しようとする、**Then** 代替フロー（質問継続 or 人気候補提示）が表示される
5. **Given** 料理提案結果画面、**When** 「レストラン検索」を選択、**Then** 近くの店舗情報と予約リンクが表示される

### エッジケース
- No回数5回制限に到達した場合の代替フロー処理
- 10問回答しても明確な料理が決まらない場合の近似候補3つ提示
- 位置情報が取得できない場合の質問調整
- 同じ料理を最近食べた場合の重複回避機能
- ネットワーク接続がない場合の基本機能提供

## 要件 *(必須)*

### 機能要件

#### 初期フェーズ要件（MVP必須実装）
- **FR-001**: システムは利用開始時にメールアドレス・パスワードによるユーザー登録を必須とする
- **FR-002**: システムは初回利用時にユーザープロファイル（好みのジャンル・アレルギー・辛さの好み・予算レンジ）の設定を必須とする
- **FR-003**: システムは最大10問のYes/No質問でユーザーの食べたいものを特定しなければならない
- **FR-004**: システムはNo回答を5回まで許可し、5回到達時は代替フロー（質問継続 or 人気候補提示）を提供しなければならない
- **FR-005**: システムは時間帯（朝・昼・夜・間食）に応じて質問内容を調整しなければならない
- **FR-006**: システムは位置情報を活用して地域特性に応じた質問を生成しなければならない
- **FR-007**: システムは質問完了後に具体的な料理名を1つ提案しなければならない
- **FR-008**: システムは基本的な食事履歴を記録しなければならない（分析・優先度調整は将来実装）
- **FR-009**: システムは質問表示から回答完了まで2秒以内のレスポンスを維持しなければならない
- **FR-010**: システムはモバイル端末での操作に最適化されたUI/UXを提供しなければならない
- **FR-011**: システムは10問以内での解決率80%以上を達成しなければならない

#### 将来フェーズ要件（段階的実装）
- **FR-101**: システムは料理提案時に複数のアクションオプション（レストラン検索・デリバリー・レシピ）を提供する
- **FR-102**: システムは過去の選択履歴を分析し、最近食べた料理の優先度を下げる学習機能を提供する  
- **FR-103**: システムは質問回答パターンを学習してユーザーの好みに合わせた質問精度を向上させる

#### 技術要件（初期フェーズ）
- **FR-012**: システムはAI質問生成サービスを使用して動的質問生成を行い、構造化されたデータ形式でレスポンスを取得しなければならない
- **FR-013**: システムはメールアドレス・パスワード認証によるユーザー管理機能を提供しなければならない
- **FR-014**: システムはユーザーデータを永続的にデータストレージに保存・管理しなければならない
- **FR-015**: システムはNext.jsフレームワークを使用してWebアプリケーションとして実装しなければならない

#### 将来技術要件（段階的実装）
- **FR-104**: システムは外部レストラン情報サービスと連携してレストラン情報を取得する
- **FR-105**: システムはデリバリーサービスと連携してオーダー機能を提供する
- **FR-106**: システムは第三者認証サービス（Google、Apple等）による認証オプションを提供する

### 主要エンティティ *(データが関わる機能の場合に含める)*
- **ユーザー**: ユーザープロファイル（好み・アレルギー・予算）、認証情報、学習データを保持
- **質問**: 質問内容、カテゴリー（気分・ジャンル・調理法・シチュエーション・時間）、条件分岐ロジック
- **料理**: 料理名、ジャンル、特徴（温冷・味・食感）、調理法、地域性
- **履歴**: 過去の質問回答履歴、選択した料理履歴、日時・場所情報
- **好み設定**: 学習された好み傾向、質問パターン最適化データ、成功率データ

---

## レビュー・受入チェックリスト

### コンテンツ品質
- [x] 実装詳細を含まない（言語、フレームワーク、API）
- [x] ユーザー価値とビジネスニーズに焦点
- [x] 非技術系ステークホルダー向けに記述
- [x] すべての必須セクションが完了

### 要件完全性
- [x] [NEEDS CLARIFICATION] マーカーが残らない（全項目明確化完了）
- [x] 要件はテスト可能で曖昧さがない
- [x] 成功基準が測定可能（80%解決率、2秒以内レスポンス等）
- [x] スコープが明確に境界設定（10問制限、5回No制限等）
- [x] 依存関係と前提条件が特定済み（AI質問生成サービス、外部レストラン情報サービス、第三者認証サービス等）

---

## 実行ステータス

- [x] ユーザー要求の解析完了
- [x] 主要概念の抽出完了
- [x] 曖昧性のマーキング完了（全項目明確化済み）
- [x] ユーザーシナリオの定義完了
- [x] 要件の生成完了
- [x] エンティティの特定完了
- [x] レビューチェックリスト通過（明確化完了）

---